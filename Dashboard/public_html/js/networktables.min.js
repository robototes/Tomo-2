function NetworkTable(m,A,B){var n=m+"/",g={},l=function(){},w=l,v=!1;m=function(){var c=chrome.sockets.tcp,b;return{create:function(a,d){c.create({},function(e){b=e.socketId;c.connect(b,a,d,l)})},send:function(a){try{c.send(b,a,l)}catch(d){}},onReceive:function(a){c.onReceive.addListener(a)},isConnected:function(){return!!b}}}();var h=B||m;h.create(A,1735);var C=function(c,b,a,d){this.name=c;this.value=b;this.type=a;this.sequence=d||0},x=function(c){var b=new ArrayBuffer(c.length),a=new DataView(b),
d=0,e;for(e in c.packets){var f=c.packets[e];switch(f.type){case "b":a.setInt8(d,f.data);d+=1;break;case "i16":a.setInt16(d,f.data);d+=2;break;case "i32":a.setInt32(d,f.data);d+=4;break;case "d":a.setFloat64(d,f.data),d+=8}}h.send(b)},y=function(c,b){for(var a=(new Uint8Array(c))[b-2]-1,d=b+a,e=new Uint8Array(c.slice(b,d)),f="",g=0;g<e.length;g++)f+=String.fromCharCode(e[g]);return{string:f,length:a,end:d}},z=function(c,b,a){var d=new Uint8Array(c),e,f;switch(a){case 0:f=1===d[b];e=b+1;break;case 1:c=
q(c,b,8);f=(new Float64Array(c.slice(b,b+8)))[0];e=b+8;break;case 2:c=y(c,b),f=c.string,e=c.end}return{value:f,end:e}},q=function(c,b,a){var d=Array(a);c=new Uint8Array(c);for(var e=0;e<a;e++)d[a-1-e]=c[e+b];c.set(d,b);return c.buffer},r=function(c){for(var b=[],a=0;a<c.length;a++)b.push(c.charCodeAt(a));return b},s=function(){h.isConnected()||console.log("Not connected.")},k=function(c){for(var b in g)if(g[b].name===c)return b;return-1};h.onReceive(function(c){try{a:{v=!0;var b=0,a=c.data;do{var a=
a.slice(b),d=new Uint8Array(a);switch(d[0]){case 3:v=!0;break a;case 16:var e=y(a,4),f=e.string,h=e.end,k=h+5,m=d[h],l=q(q(a.slice(h+1,h+5),0,2),2,2),t=new Uint16Array(l),p=t[0],r=t[1],u=z(a,k,m);0===f.indexOf(n)&&(g[p]=new C(f,u.value,m,r));b=u.end;break;case 17:l=q(q(a.slice(1,5),0,2),2,2),t=new Uint16Array(l),p=t[0],k=5,g[p]&&(u=z(a,k,g[p].type),g[p].value=u.value,g[p].sequence=t[1]),b=u.end}}while(void 0!==d[b]);w()}}catch(s){console.log(s)}});return{get:function(c,b){var a=k(n+c);return 0<=a?
g[a].value:b},set:function(c,b){if(0<=k(n+c)){var a=n+c;s();var d=k(a),a={length:1,packets:[{type:"b",data:17}]};a.packets.push({type:"i16",data:d});a.packets.push({type:"i16",data:++g[d].sequence});a.length+=4;switch(typeof b){case "boolean":a.packets.push({type:"b",data:b?1:0});a.length+=1;break;case "number":a.packets.push({type:"d",data:b});a.length+=8;break;case "string":d=b.length;a.length+=d;a.packets.push({type:"i16",data:d});for(var e=r(b),f=0;f<d;f++)a.packets.push({type:"b",data:e[f]}),
a.length+=1}}else{e=n+c;s();a={length:3,packets:[{type:"b",data:16}]};d=e.length;a.length+=d+1;a.packets.push({type:"i16",data:d+1});a.packets.push({type:"b",data:47});e=r(e);for(f=0;f<d;f++)a.packets.push({type:"b",data:e[f]});switch(typeof b){case "boolean":a.packets.push({type:"b",data:0});break;case "number":a.packets.push({type:"b",data:1});break;case "string":a.packets.push({type:"b",data:2})}a.length+=5;a.packets.push({type:"i16",data:65535});a.packets.push({type:"i16",data:0});switch(typeof b){case "boolean":a.packets.push({type:"b",
data:b?1:0});a.length+=1;break;case "number":a.packets.push({type:"d",data:b});a.length+=8;break;case "string":for(d=b.length,a.length+=d,a.packets.push({type:"i16",data:d}),e=r(b),f=0;f<d;f++)a.packets.push({type:"b",data:e[f]}),a.length+=1}}x(a)},setCallback:function(c){w=c},connect:function(){s();x({length:3,packets:[{type:"b",data:1},{type:"i16",data:512}]})},isConnected:function(){return v},getTypeAndID:function(c){c=k(n+c);return{type:g[c].type,id:c}}}};
